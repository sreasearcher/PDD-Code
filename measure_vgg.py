from torchstat import stat
from torchvision.models import vgg16
import numpy as np

model = vgg16()
stat(model, (3, 224, 224))

vgg_f = np.array([
    89915392+3211264,
    1852899328+3211264+3211264,
    926449664+1605632,
    1851293696+1605632+1605632,
    925646848+802816,
    1850490880+802816,
    1850490880+802816+802816,
    925245440+401408,
    1850089472+401408,
    1850089472+401408+401408,
    462522368+100352,
    462522368+100352,
    462522368+100352+100352,
    102760448.0+4096,
    16777216+4096,
    4096000
])

vgg_o = np.array([
    3*224*224,
    64*224*224,
    64*112*112,
    128*112*112,
    128*56*56,
    256*56*56,
    256*56*56,
    256*28*28,
    512*28*28,
    512*28*28,
    512*14*14,
    512*14*14,
    512*14*14,
    512*7*7,
    4096,
    4096
])/1024/1024*8

print(vgg_o)
